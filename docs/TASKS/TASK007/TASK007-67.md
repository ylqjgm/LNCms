# TASK007-67: 创建AudioSeasonHandler和AudioEpisodeHandler接口和实现

## 任务信息

**任务编号**: TASK007-67  
**父任务**: TASK007  
**任务名称**: 创建AudioSeasonHandler和AudioEpisodeHandler接口和实现  
**版本信息**: v1.2.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-04 00:01:47 CST

## 任务描述

创建音频分季和分集控制器，提供音频分季和分集管理的HTTP API处理。包括：1) 定义AudioSeasonHandler和AudioEpisodeHandler接口；2) 实现分季和分集的CRUD API端点；3) 调用对应的Service；4) 格式化响应（Envelope格式）。所有代码必须遵循API设计规范。

## 依赖任务

TASK007-49（创建AudioSeasonService接口和实现）、TASK007-50（创建AudioEpisodeService接口和实现）

## 实现指南

### 1. 创建AudioSeasonHandler接口文件

在 `internal/handler/` 目录下创建 `audio_season_handler.go` 文件，定义AudioSeasonHandler接口：

```go
package handler

import (
    "github.com/gin-gonic/gin"
)

// AudioSeasonHandler 音频分季控制器接口
// 提供音频分季管理的HTTP API处理
type AudioSeasonHandler interface {
    // GetSeasons 获取分季列表
    GetSeasons(c *gin.Context)
    
    // GetSeason 根据ID获取分季
    GetSeason(c *gin.Context)
    
    // CreateSeason 创建分季（需要作者或管理员权限）
    CreateSeason(c *gin.Context)
    
    // UpdateSeason 更新分季（需要作者或管理员权限）
    UpdateSeason(c *gin.Context)
    
    // DeleteSeason 删除分季（需要作者或管理员权限）
    DeleteSeason(c *gin.Context)
}
```

### 2. 创建AudioEpisodeHandler接口文件

在 `internal/handler/` 目录下创建 `audio_episode_handler.go` 文件，定义AudioEpisodeHandler接口：

```go
package handler

import (
    "github.com/gin-gonic/gin"
)

// AudioEpisodeHandler 音频分集控制器接口
// 提供音频分集管理的HTTP API处理
type AudioEpisodeHandler interface {
    // GetEpisodes 获取分集列表（支持分页、排序）
    GetEpisodes(c *gin.Context)
    
    // GetEpisode 根据ID获取分集
    GetEpisode(c *gin.Context)
    
    // CreateEpisode 创建分集（需要作者或管理员权限）
    CreateEpisode(c *gin.Context)
    
    // UpdateEpisode 更新分集（需要作者或管理员权限）
    UpdateEpisode(c *gin.Context)
    
    // DeleteEpisode 删除分集（需要作者或管理员权限）
    DeleteEpisode(c *gin.Context)
    
    // UpdateEpisodeStatus 更新分集状态（需要作者或管理员权限）
    UpdateEpisodeStatus(c *gin.Context)
}
```

### 3. 实现AudioSeasonHandler和AudioEpisodeHandler接口

参考NovelVolumeHandler和NovelChapterHandler的实现方式，实现音频分季和分集的CRUD操作。实现逻辑与NovelVolumeHandler和NovelChapterHandler类似，但调用AudioSeasonService和AudioEpisodeService的方法。

### 4. 定义请求结构体

参考NovelVolumeHandler和NovelChapterHandler的请求结构体，定义音频分季和分集的请求结构体。

### 5. 添加必要的导入

```go
package handler

import (
    "errors"
    "fmt"
    "net/http"
    "strconv"
    
    "github.com/gin-gonic/gin"
    
    "yourproject/internal/models"
    "yourproject/internal/repository"
    "yourproject/internal/response"
    "yourproject/internal/service"
)
```

### 6. 注意事项

- **API规范**：所有API必须遵循OpenAPI 3.1.1规范
- **响应格式**：所有响应必须使用Envelope格式
- **权限验证**：创建、更新、删除操作需要作者或管理员权限（参考NovelHandler的实现）
- **分页支持**：GetEpisodes方法支持分页，需要使用BuildPaginatedResponse
- **参数验证**：使用Gin的binding进行请求参数验证
- **错误处理**：所有错误消息必须使用中文

## 验收标准

1. **接口定义完整**
   - AudioSeasonHandler和AudioEpisodeHandler接口包含所有必需方法
   - 方法签名正确

2. **请求处理完整**
   - 所有CRUD操作正确实现
   - 权限验证正确
   - 参数验证正确

3. **响应格式**
   - 所有响应使用Envelope格式
   - 成功响应格式正确
   - 错误响应格式正确

4. **错误处理**
   - 所有错误消息使用中文
   - HTTP状态码使用正确

5. **代码规范**
   - 遵循Golang编码规范
   - 遵循API设计规范

## 相关文件

- `docs/TASKS/TASK007/TASK007-49.md` - AudioSeasonService实现文档
- `docs/TASKS/TASK007/TASK007-50.md` - AudioEpisodeService实现文档
- `docs/TASKS/TASK007/TASK007-61.md` - NovelVolumeHandler和NovelChapterHandler实现参考
- `.cursor/rules/api-design.mdc` - API设计规范
- `internal/handler/audio_season_handler.go` - AudioSeasonHandler文件（待创建）
- `internal/handler/audio_episode_handler.go` - AudioEpisodeHandler文件（待创建）

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

**文档版本**: 1.0  
**最后更新**: 2026-01-04 00:01:47 CST

