# TASK006-07: 复用PasswordService（无需修改）

## 任务信息

**任务编号**: TASK006-07  
**父任务**: TASK006  
**任务名称**: 复用PasswordService（无需修改）  
**版本信息**: v1.2.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-03 20:48:19 CST

## 任务描述

复用TASK005-07实现的PasswordService，无需修改。作者管理系统使用相同的密码加密和验证逻辑。在AuthorService中注入PasswordService依赖。

## 依赖任务

无

## 实现指南

### 1. 确认PasswordService已实现

确认TASK005-07已经完成，PasswordService接口和实现已经存在：
- 接口定义：`internal/service/password_service.go`
- 实现：包含HashPassword、VerifyPassword、ValidatePasswordStrength等方法

### 2. 在AuthorService中注入PasswordService

在创建AuthorService时，注入PasswordService依赖：

```go
package service

import (
    "yourproject/internal/repository"
    "yourproject/internal/service"
)

// authorService AuthorService的实现
type authorService struct {
    authorRepo      repository.AuthorRepository
    passwordService service.PasswordService
}

// NewAuthorService 创建AuthorService实例
func NewAuthorService(
    authorRepo repository.AuthorRepository,
    passwordService service.PasswordService,
) AuthorService {
    return &authorService{
        authorRepo:      authorRepo,
        passwordService: passwordService,
    }
}
```

### 3. 使用PasswordService的方法

在AuthorService中使用PasswordService的方法：

```go
// CreateAuthor 创建作者（示例）
func (s *authorService) CreateAuthor(ctx context.Context, req *CreateAuthorRequest) (*models.Author, error) {
    // 验证密码强度
    if err := s.passwordService.ValidatePasswordStrength(req.Password); err != nil {
        return nil, fmt.Errorf("密码强度不符合要求: %w", err)
    }
    
    // 哈希密码
    passwordHash, err := s.passwordService.HashPassword(req.Password)
    if err != nil {
        return nil, fmt.Errorf("密码加密失败: %w", err)
    }
    
    // 创建作者
    author := &models.Author{
        AuthorName:   req.AuthorName,
        Email:        req.Email,
        PasswordHash: passwordHash,
        // ... 其他字段
    }
    
    if err := s.authorRepo.Create(ctx, author); err != nil {
        return nil, err
    }
    
    return author, nil
}

// VerifyAuthorPassword 验证作者密码（示例）
func (s *authorService) VerifyAuthorPassword(ctx context.Context, author *models.Author, password string) bool {
    return s.passwordService.VerifyPassword(author.PasswordHash, password)
}
```

### 4. 注意事项

- **直接复用**：PasswordService的实现完全适用于作者管理系统，无需修改
- **依赖注入**：在AuthorService构造函数中注入PasswordService
- **方法使用**：使用PasswordService的HashPassword、VerifyPassword、ValidatePasswordStrength方法
- **错误处理**：PasswordService返回的错误消息已经是中文，直接使用即可

## 验收标准

1. **依赖注入正确**
   - AuthorService构造函数接受PasswordService参数
   - PasswordService正确注入到AuthorService中

2. **方法使用正确**
   - 在需要密码加密的地方使用HashPassword方法
   - 在需要密码验证的地方使用VerifyPassword方法
   - 在需要密码强度验证的地方使用ValidatePasswordStrength方法

3. **错误处理正确**
   - PasswordService的错误消息正确传递
   - 错误处理符合业务逻辑

4. **代码规范**
   - 遵循Golang编码规范
   - 依赖注入模式正确

## 相关文件

- `docs/TASKS/TASK005/TASK005-07.md` - 密码服务实现文档
- `internal/service/password_service.go` - PasswordService接口和实现文件（已存在）
- `internal/service/author_service.go` - AuthorService文件（待创建，需要注入PasswordService）

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

**文档版本**: 1.0  
**最后更新**: 2026-01-03 20:48:19 CST

