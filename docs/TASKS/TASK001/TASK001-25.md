# TASK001-25: 定义Envelope响应结构体

## 任务信息

**任务编号**: TASK001-25  
**父任务**: TASK001  
**任务名称**: 定义Envelope响应结构体  
**版本信息**: v1.0.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-02 21:44:12 CST

## 任务描述

定义Envelope响应格式结构体，包括Meta（元数据）、Data（数据）、Errors（错误）、Links（链接）等部分，符合OpenAPI 3.1.1规范和项目API设计规范。

## 依赖任务

- TASK001-22: 定义错误类型结构体

## 实现指南

### 1. 创建Envelope响应结构体文件

创建 `internal/response/envelope.go` 文件，定义Envelope响应结构体。

### 2. 定义Meta结构体

定义Meta结构体（Success、Code、Message、Timestamp、RequestID、Pagination等字段）：

```go
// Meta 响应元数据
type Meta struct {
    Success   bool        `json:"success"`              // 请求是否成功
    Code      int         `json:"code"`                 // 响应代码（0表示成功）
    Message   string      `json:"message"`              // 响应消息
    Timestamp string      `json:"timestamp"`            // 响应时间戳（ISO 8601格式，UTC）
    RequestID string      `json:"request_id"`           // 请求唯一标识符
    Pagination *Pagination `json:"pagination,omitempty"` // 分页信息（仅在有分页时存在）
}
```

### 3. 定义Pagination结构体

定义Pagination结构体（Page、Limit、Total、Pages、HasNext、HasPrevious等字段）：

```go
// Pagination 分页信息
type Pagination struct {
    Page        int  `json:"page"`         // 当前页码（从1开始）
    Limit       int  `json:"limit"`        // 每页数量
    Total       int  `json:"total"`        // 总记录数
    Pages       int  `json:"pages"`        // 总页数
    HasNext     bool `json:"has_next"`     // 是否有下一页
    HasPrevious bool `json:"has_previous"` // 是否有上一页
}
```

### 4. 定义Links结构体

定义Links结构体（Self、First、Last、Next、Prev等字段）：

```go
// Links 链接信息
type Links struct {
    Self  string  `json:"self"`  // 当前页链接
    First string  `json:"first"` // 第一页链接
    Last  string  `json:"last"`  // 最后一页链接
    Next  *string `json:"next"`  // 下一页链接（可为null）
    Prev  *string `json:"prev"`  // 上一页链接（可为null）
}
```

### 5. 定义Error结构体

定义Error结构体（Code、Message、Field等字段）：

```go
// Error 错误信息
type Error struct {
    Code    string `json:"code"`    // 错误代码
    Message string `json:"message"` // 错误消息（中文）
    Field   string `json:"field,omitempty"` // 错误字段（如果适用）
}
```

### 6. 定义Envelope结构体

定义Envelope结构体（Meta、Data、Errors、Links字段）：

```go
// Envelope 响应封装
type Envelope struct {
    Meta   Meta        `json:"meta"`              // 元数据
    Data   interface{} `json:"data"`              // 数据内容（可为null）
    Errors []Error     `json:"errors"`            // 错误信息数组
    Links  *Links      `json:"links,omitempty"`  // 链接信息（仅在有分页时存在）
}
```

### 7. 为所有结构体添加json标签和中文注释

为所有结构体添加json标签和中文注释，确保符合OpenAPI 3.1.1规范。

### 8. 确保结构体符合OpenAPI 3.1.1规范

确保所有结构体符合OpenAPI 3.1.1规范，字段命名使用小写字母和下划线。

## 验收标准

1. **Envelope响应结构体已定义**
   - Meta结构体已定义
   - Pagination结构体已定义
   - Links结构体已定义
   - Error结构体已定义
   - Envelope结构体已定义

2. **包含Meta、Data、Errors、Links等所有必需字段**
   - Meta字段包含所有必需子字段
   - Data字段支持任意类型
   - Errors字段为错误数组
   - Links字段可选（仅在有分页时存在）

3. **结构体符合OpenAPI 3.1.1规范**
   - 字段命名使用小写字母和下划线
   - 字段类型符合规范
   - 可选字段使用omitempty标签

4. **所有字段都有json标签和中文注释**
   - 所有字段都有json标签
   - 所有字段都有中文注释
   - 注释说明字段的用途和取值范围

## 相关文件

- `internal/response/envelope.go` - Envelope响应结构体定义文件

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

**文档版本**: 1.0  
**最后更新**: 2026-01-02 21:44:12 CST

