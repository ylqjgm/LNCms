# TASK001-04: 实现环境变量读取功能

## 任务信息

**任务编号**: TASK001-04  
**父任务**: TASK001  
**任务名称**: 实现环境变量读取功能  
**版本信息**: v1.0.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-02 21:44:12 CST

## 任务描述

实现从环境变量读取配置的功能，支持通过os.Getenv读取环境变量，并将环境变量值映射到配置结构体。

## 依赖任务

- TASK001-03: 定义配置结构体

## 实现指南

### 1. 创建环境变量读取文件

创建 `internal/config/env_loader.go` 文件，实现环境变量读取功能。

### 2. 实现LoadFromEnv函数

实现 `LoadFromEnv` 函数，从环境变量读取配置：

```go
// LoadFromEnv 从环境变量读取配置
func LoadFromEnv() (*Config, error) {
    config := &Config{}
    
    // 读取服务器配置
    if port := os.Getenv("SERVER_HTTP_PORT"); port != "" {
        if p, err := strconv.Atoi(port); err == nil {
            config.Server.HTTPPort = p
        }
    }
    
    // 读取数据库配置
    config.Database.Host = os.Getenv("DATABASE_HOST")
    // ... 更多配置读取
    
    return config, nil
}
```

### 3. 环境变量命名规范

环境变量命名应使用大写字母和下划线，遵循常见的环境变量命名规范：
- `SERVER_HTTP_PORT` - HTTP端口
- `DATABASE_HOST` - 数据库主机
- `REDIS_HOST` - Redis主机
- `ELASTICSEARCH_URLS` - Elasticsearch URL列表

### 4. 类型转换处理

实现环境变量值的类型转换：
- 字符串转整数：使用 `strconv.Atoi`
- 字符串转布尔值：使用 `strconv.ParseBool`
- 字符串转时间：使用 `time.Parse`
- 字符串转切片：使用 `strings.Split`

### 5. 处理环境变量不存在的情况

当环境变量不存在时，返回默认值或错误：
- 必填项：返回错误
- 可选项：使用默认值

## 验收标准

1. **可以从环境变量读取所有配置项**
   - 服务器配置可以正确读取
   - 数据库配置可以正确读取
   - Redis配置可以正确读取
   - Elasticsearch配置可以正确读取
   - 日志配置可以正确读取

2. **环境变量值可以正确转换为配置结构体字段类型**
   - 字符串转整数正确
   - 字符串转布尔值正确
   - 字符串转时间正确
   - 字符串转切片正确

3. **处理了环境变量不存在的情况**
   - 必填项不存在时返回错误
   - 可选项不存在时使用默认值

4. **环境变量命名规范统一**
   - 使用大写字母和下划线
   - 命名清晰、具有描述性

## 相关文件

- `internal/config/env_loader.go` - 环境变量读取功能实现文件

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

**文档版本**: 1.0  
**最后更新**: 2026-01-02 21:44:12 CST
