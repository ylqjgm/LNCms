# TASK001-27: 实现错误码到HTTP状态码映射

## 任务信息

**任务编号**: TASK001-27  
**父任务**: TASK001  
**任务名称**: 实现错误码到HTTP状态码映射  
**版本信息**: v1.0.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-02 21:44:12 CST

## 任务描述

实现错误码到HTTP状态码的映射功能，根据错误码自动确定对应的HTTP状态码，用于构建正确的HTTP响应。

## 依赖任务

- TASK001-23: 定义错误码常量

## 实现指南

### 1. 创建错误码到HTTP状态码映射文件

创建 `internal/response/status.go` 文件，实现错误码到HTTP状态码映射功能。

### 2. 实现ErrorCodeToHTTPStatus函数

实现ErrorCodeToHTTPStatus函数，将错误码映射到HTTP状态码：

```go
// ErrorCodeToHTTPStatus 将错误码映射到HTTP状态码
func ErrorCodeToHTTPStatus(errorCode string) int {
    code := errorCodeToInt(errorCode)
    
    // 系统错误（1000-1999）→ 500 Internal Server Error
    if code >= 1000 && code < 2000 {
        return http.StatusInternalServerError
    }
    
    // 业务错误（2000-2999）
    if code >= 2000 && code < 3000 {
        switch code {
        case 2000: // 参数验证错误
            return http.StatusUnprocessableEntity // 422
        case 2001: // 资源不存在
            return http.StatusNotFound // 404
        case 2002: // 未授权
            return http.StatusUnauthorized // 401
        case 2003: // 权限不足
            return http.StatusForbidden // 403
        default:
            return http.StatusBadRequest // 400
        }
    }
    
    // 第三方服务错误（3000-3999）→ 502 Bad Gateway
    if code >= 3000 && code < 4000 {
        return http.StatusBadGateway
    }
    
    // 默认返回500
    return http.StatusInternalServerError
}
```

### 3. 定义映射规则

定义映射规则：
- 系统错误（1000-1999）→ 500 Internal Server Error
- 业务错误-验证错误（2000）→ 422 Unprocessable Entity
- 业务错误-资源不存在（2001）→ 404 Not Found
- 业务错误-未授权（2002）→ 401 Unauthorized
- 业务错误-权限不足（2003）→ 403 Forbidden
- 第三方服务错误（3000-3999）→ 502 Bad Gateway

### 4. 实现HTTPStatusToErrorCode反向映射（如需要）

可选：实现HTTPStatusToErrorCode反向映射函数，用于从HTTP状态码获取错误码。

### 5. 为映射函数添加中文注释

为映射函数添加中文注释，说明映射规则和使用方法。

## 验收标准

1. **错误码可以正确映射到HTTP状态码**
   - 系统错误码正确映射到500
   - 业务错误码正确映射到对应状态码
   - 第三方服务错误码正确映射到502

2. **映射规则符合HTTP标准**
   - 映射规则遵循HTTP标准
   - 状态码选择合理
   - 状态码语义正确

3. **所有错误码都有对应的HTTP状态码**
   - 所有错误码范围都有映射规则
   - 默认映射规则合理

4. **映射函数注释完整**
   - 函数有清晰的中文注释
   - 注释说明映射规则
   - 注释说明使用方法

## 相关文件

- `internal/response/status.go` - 错误码到HTTP状态码映射实现文件

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

**文档版本**: 1.0  
**最后更新**: 2026-01-02 21:44:12 CST

