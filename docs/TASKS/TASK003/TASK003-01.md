# TASK003-01: 创建SystemConfig模型

## 任务信息

**任务编号**: TASK003-01  
**父任务**: TASK003  
**任务名称**: 创建SystemConfig模型  
**版本信息**: v2.0.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-03 13:31:24 CST

## 任务描述

创建系统配置的GORM模型，定义配置表结构。包括：1) 创建SystemConfig模型，定义字段（id、config_type、config_data、created_at、updated_at）；2) 添加模型标签和索引定义；3) 添加表注释。所有代码必须遵循Golang编码规范和PostgreSQL数据库设计规范。

## 依赖任务

无

## 实现指南

### 1. 创建SystemConfig模型

在 `internal/pkg/model/system_config.go` 文件中创建SystemConfig结构体：

```go
package model

import (
    "time"
    "gorm.io/datatypes"
)

// SystemConfig 系统配置模型
type SystemConfig struct {
    ID         int64          `gorm:"primaryKey;autoIncrement" json:"id"`
    ConfigType string         `gorm:"type:varchar(50);not null;uniqueIndex:uk_system_configs_config_type" json:"config_type"`
    ConfigData datatypes.JSON `gorm:"type:jsonb;not null" json:"config_data"`
    CreatedAt  time.Time      `gorm:"type:timestamptz;default:current_timestamp" json:"created_at"`
    UpdatedAt  time.Time      `gorm:"type:timestamptz;default:current_timestamp" json:"updated_at"`
}

// TableName 指定表名
func (SystemConfig) TableName() string {
    return "system_configs"
}
```

### 2. 添加模型注释

在模型定义后添加注释说明：

```go
// SystemConfig 系统配置模型
// 用于存储系统各种配置信息，包括网站设置、注册设置、站群设置、积分设置、附件设置、邮箱设置、屏蔽设置等
// 表名: system_configs
// 索引: uk_system_configs_config_type (config_type字段唯一索引)
type SystemConfig struct {
    // ID 主键，自增
    ID int64 `gorm:"primaryKey;autoIncrement" json:"id"`
    
    // ConfigType 配置类型，唯一索引，用于区分不同类型的配置
    ConfigType string `gorm:"type:varchar(50);not null;uniqueIndex:uk_system_configs_config_type" json:"config_type"`
    
    // ConfigData 配置数据，JSONB格式，存储具体的配置内容
    ConfigData datatypes.JSON `gorm:"type:jsonb;not null" json:"config_data"`
    
    // CreatedAt 创建时间，自动设置为当前时间
    CreatedAt time.Time `gorm:"type:timestamptz;default:current_timestamp" json:"created_at"`
    
    // UpdatedAt 更新时间，自动设置为当前时间
    UpdatedAt time.Time `gorm:"type:timestamptz;default:current_timestamp" json:"updated_at"`
}
```

### 3. 验证模型定义

确保模型定义符合以下要求：

- 主键字段使用 `bigserial` 类型（GORM会自动映射）
- `config_type` 字段使用 `varchar(50)` 类型，设置唯一索引
- `config_data` 字段使用 `jsonb` 类型，支持高效的JSON查询
- 时间字段使用 `timestamptz` 类型，支持时区
- 所有字段都有适当的GORM标签和JSON标签
- 模型实现了 `TableName()` 方法，明确指定表名

## 验收标准

1. **SystemConfig模型正确定义**
   - 模型包含所有必需字段：id、config_type、config_data、created_at、updated_at
   - 字段类型正确，符合PostgreSQL数据库设计规范
   - GORM标签完整，包括主键、索引、类型等

2. **索引定义正确**
   - config_type字段定义了唯一索引（uk_system_configs_config_type）
   - 索引命名符合PostgreSQL命名规范

3. **代码规范符合要求**
   - 代码通过golangci-lint检查，无错误和警告
   - 代码注释完整，使用中文
   - 字段命名符合Golang编码规范

4. **模型结构清晰**
   - 模型职责单一，只负责数据模型定义
   - 不包含业务逻辑代码
   - 不包含仓储层或服务层代码

## 相关文件

- `internal/pkg/model/system_config.go` - 系统配置模型定义
- `docs/Requirements/Core.md` - 核心模块需求文档
- `.cursor/rules/golang.mdc` - Golang编码规范
- `.cursor/rules/database.mdc` - PostgreSQL数据库设计规范

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

**文档版本**: 2.0.0  
**最后更新**: 2026-01-03 13:31:24 CST
