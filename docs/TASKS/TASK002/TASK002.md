# TASK002: 数据库设计和初始化

## 任务信息

**任务编号**: TASK002  
**任务名称**: 数据库设计和初始化  
**版本信息**: v1.0.0  
**当前状态**: 计划中  
**创建时间**: 2026-01-02 21:13:22 CST

## 任务描述

完成项目数据库设计，包括核心模块、存储模块、日志模块、采集模块的数据库表结构设计。设计用户表、作者表、内容表、消费表、文件表、日志表等核心表结构。创建数据库迁移脚本，初始化数据库表结构和基础数据。

这是项目的基础设施任务，为后续所有业务功能提供数据存储支撑。所有数据库设计必须遵循 PostgreSQL 数据库设计规范，包括命名规范、表结构设计、索引设计、性能优化、元数据配置等。

## 技术栈

- **数据库**: PostgreSQL
- **ORM**: GORM
- **迁移工具**: golang-migrate
- **设计规范**: PostgreSQL 数据库设计规范

## 子任务列表

> **注意**: 本任务已按照"一个任务仅操作一个功能"的标准进行细化拆分，将原来的10个粗粒度任务细化为61个独立任务。每个任务专注于一个数据库表的设计或一个功能模块的迁移脚本/初始化脚本。

### 核心模块数据库设计（40个任务）

#### 系统配置（1个任务）

**TASK002-01**: 数据库设计 - 核心模块 - 系统配置表  
**依赖任务**: 无  
**详细文档**: [TASK002-01.md](TASK002-01.md)

#### 权限管理（8个任务）

**TASK002-02**: 数据库设计 - 核心模块 - 角色表  
**依赖任务**: 无  
**详细文档**: [TASK002-02.md](TASK002-02.md)

**TASK002-03**: 数据库设计 - 核心模块 - 用户组表  
**依赖任务**: 无  
**详细文档**: [TASK002-03.md](TASK002-03.md)

**TASK002-04**: 数据库设计 - 核心模块 - 等级表  
**依赖任务**: 无  
**详细文档**: [TASK002-04.md](TASK002-04.md)

**TASK002-05**: 数据库设计 - 核心模块 - 作者类型表  
**依赖任务**: 无  
**详细文档**: [TASK002-05.md](TASK002-05.md)

**TASK002-06**: 数据库设计 - 核心模块 - 作者等级表  
**依赖任务**: 无  
**详细文档**: [TASK002-06.md](TASK002-06.md)

**TASK002-07**: 数据库设计 - 核心模块 - 权限表  
**依赖任务**: 无  
**详细文档**: [TASK002-07.md](TASK002-07.md)

**TASK002-08**: 数据库设计 - 核心模块 - 角色权限关联表  
**依赖任务**: TASK002-02、TASK002-07  
**详细文档**: [TASK002-08.md](TASK002-08.md)

**TASK002-09**: 数据库设计 - 核心模块 - 用户组权限关联表  
**依赖任务**: TASK002-03、TASK002-07  
**详细文档**: [TASK002-09.md](TASK002-09.md)

#### 用户管理（3个任务）

**TASK002-10**: 数据库设计 - 核心模块 - 用户表  
**依赖任务**: TASK002-03、TASK002-04  
**详细文档**: [TASK002-10.md](TASK002-10.md)

**TASK002-11**: 数据库设计 - 核心模块 - 用户资料表  
**依赖任务**: TASK002-10  
**详细文档**: [TASK002-11.md](TASK002-11.md)

**TASK002-12**: 数据库设计 - 核心模块 - 用户设置表  
**依赖任务**: TASK002-10  
**详细文档**: [TASK002-12.md](TASK002-12.md)

#### 作者管理（3个任务）

**TASK002-13**: 数据库设计 - 核心模块 - 作者表  
**依赖任务**: TASK002-10、TASK002-05（作者类型表）、TASK002-06  
**详细文档**: [TASK002-13.md](TASK002-13.md)

**TASK002-14**: 数据库设计 - 核心模块 - 作者资料表  
**依赖任务**: TASK002-13  
**详细文档**: [TASK002-14.md](TASK002-14.md)

**TASK002-15**: 数据库设计 - 核心模块 - 作者设置表  
**依赖任务**: TASK002-13  
**详细文档**: [TASK002-15.md](TASK002-15.md)

#### 内容管理（17个任务）

**TASK002-16**: 数据库设计 - 核心模块 - 分类表  
**依赖任务**: 无  
**详细文档**: [TASK002-16.md](TASK002-16.md)

**TASK002-17**: 数据库设计 - 核心模块 - 地区表  
**依赖任务**: 无  
**详细文档**: [TASK002-17.md](TASK002-17.md)

**TASK002-18**: 数据库设计 - 核心模块 - 标签表  
**依赖任务**: 无  
**详细文档**: [TASK002-18.md](TASK002-18.md)

**TASK002-19**: 数据库设计 - 核心模块 - 小说表  
**依赖任务**: TASK002-13、TASK002-16  
**详细文档**: [TASK002-19.md](TASK002-19.md)

**TASK002-20**: 数据库设计 - 核心模块 - 小说分卷表  
**依赖任务**: TASK002-19  
**详细文档**: [TASK002-20.md](TASK002-20.md)

**TASK002-21**: 数据库设计 - 核心模块 - 小说章节表  
**依赖任务**: TASK002-20  
**详细文档**: [TASK002-21.md](TASK002-21.md)

**TASK002-22**: 数据库设计 - 核心模块 - 小说章节附件表  
**依赖任务**: TASK002-21  
**详细文档**: [TASK002-22.md](TASK002-22.md)

**TASK002-23**: 数据库设计 - 核心模块 - 漫画表  
**依赖任务**: TASK002-13  
**详细文档**: [TASK002-23.md](TASK002-23.md)

**TASK002-24**: 数据库设计 - 核心模块 - 漫画章节表  
**依赖任务**: TASK002-23  
**详细文档**: [TASK002-24.md](TASK002-24.md)

**TASK002-25**: 数据库设计 - 核心模块 - 漫画章节图片表  
**依赖任务**: TASK002-24  
**详细文档**: [TASK002-25.md](TASK002-25.md)

**TASK002-26**: 数据库设计 - 核心模块 - 音频表  
**依赖任务**: TASK002-13  
**详细文档**: [TASK002-26.md](TASK002-26.md)

**TASK002-27**: 数据库设计 - 核心模块 - 音频分季表  
**依赖任务**: TASK002-26  
**详细文档**: [TASK002-27.md](TASK002-27.md)

**TASK002-28**: 数据库设计 - 核心模块 - 音频分集表  
**依赖任务**: TASK002-27  
**详细文档**: [TASK002-28.md](TASK002-28.md)

**TASK002-29**: 数据库设计 - 核心模块 - 视频表  
**依赖任务**: TASK002-13  
**详细文档**: [TASK002-29.md](TASK002-29.md)

**TASK002-30**: 数据库设计 - 核心模块 - 视频分季表  
**依赖任务**: TASK002-29  
**详细文档**: [TASK002-30.md](TASK002-30.md)

**TASK002-31**: 数据库设计 - 核心模块 - 视频分集表  
**依赖任务**: TASK002-30  
**详细文档**: [TASK002-31.md](TASK002-31.md)

**TASK002-32**: 数据库设计 - 核心模块 - 内容标签关联表  
**依赖任务**: TASK002-18、TASK002-19、TASK002-23、TASK002-26、TASK002-29  
**详细文档**: [TASK002-32.md](TASK002-32.md)

#### 消费管理（6个任务）

**TASK002-33**: 数据库设计 - 核心模块 - 渠道表  
**依赖任务**: 无  
**详细文档**: [TASK002-33.md](TASK002-33.md)

**TASK002-34**: 数据库设计 - 核心模块 - 虚拟物品表  
**依赖任务**: 无  
**详细文档**: [TASK002-34.md](TASK002-34.md)

**TASK002-35**: 数据库设计 - 核心模块 - 票务表  
**依赖任务**: TASK002-10  
**详细文档**: [TASK002-35.md](TASK002-35.md)

**TASK002-36**: 数据库设计 - 核心模块 - 退费表  
**依赖任务**: TASK002-37  
**详细文档**: [TASK002-36.md](TASK002-36.md)

**TASK002-37**: 数据库设计 - 核心模块 - 流水表  
**依赖任务**: TASK002-10、TASK002-33  
**详细文档**: [TASK002-37.md](TASK002-37.md)

**TASK002-38**: 数据库设计 - 核心模块 - 作者收益表  
**依赖任务**: TASK002-13、TASK002-37  
**详细文档**: [TASK002-38.md](TASK002-38.md)

#### 互动管理（2个任务）

**TASK002-39**: 数据库设计 - 核心模块 - 评论表  
**依赖任务**: TASK002-10、TASK002-19、TASK002-23、TASK002-26、TASK002-29  
**详细文档**: [TASK002-39.md](TASK002-39.md)

**TASK002-40**: 数据库设计 - 核心模块 - 弹幕表  
**依赖任务**: TASK002-10、TASK002-24、TASK002-30  
**详细文档**: [TASK002-40.md](TASK002-40.md)

### 存储模块数据库设计（5个任务）

**TASK002-41**: 数据库设计 - 存储模块 - 文件表  
**依赖任务**: 无  
**详细文档**: [TASK002-41.md](TASK002-41.md)

**TASK002-42**: 数据库设计 - 存储模块 - 上传记录表  
**依赖任务**: TASK002-41  
**详细文档**: [TASK002-42.md](TASK002-42.md)

**TASK002-43**: 数据库设计 - 存储模块 - 转码记录表  
**依赖任务**: TASK002-41  
**详细文档**: [TASK002-43.md](TASK002-43.md)

**TASK002-44**: 数据库设计 - 存储模块 - 迁移记录表  
**依赖任务**: 无  
**详细文档**: [TASK002-44.md](TASK002-44.md)

**TASK002-45**: 数据库设计 - 存储模块 - 预览记录表  
**依赖任务**: TASK002-41  
**详细文档**: [TASK002-45.md](TASK002-45.md)

### 日志模块数据库设计（2个任务）

**TASK002-46**: 数据库设计 - 日志模块 - 日志表  
**依赖任务**: 无  
**详细文档**: [TASK002-46.md](TASK002-46.md)

**TASK002-47**: 数据库设计 - 日志模块 - 日志归档表  
**依赖任务**: 无  
**详细文档**: [TASK002-47.md](TASK002-47.md)

### 采集模块数据库设计（3个任务）

**TASK002-48**: 数据库设计 - 采集模块 - 采集规则表  
**依赖任务**: 无  
**详细文档**: [TASK002-48.md](TASK002-48.md)

**TASK002-49**: 数据库设计 - 采集模块 - 采集任务表  
**依赖任务**: TASK002-48  
**详细文档**: [TASK002-49.md](TASK002-49.md)

**TASK002-50**: 数据库设计 - 采集模块 - 采集数据表  
**依赖任务**: TASK002-48、TASK002-49  
**详细文档**: [TASK002-50.md](TASK002-50.md)

### 数据库迁移脚本（4个任务）

**TASK002-51**: 数据库迁移脚本 - 核心模块  
**依赖任务**: TASK002-40  
**详细文档**: [TASK002-51.md](TASK002-51.md)

**TASK002-52**: 数据库迁移脚本 - 存储模块  
**依赖任务**: TASK002-45  
**详细文档**: [TASK002-52.md](TASK002-52.md)

**TASK002-53**: 数据库迁移脚本 - 日志模块  
**依赖任务**: TASK002-47  
**详细文档**: [TASK002-53.md](TASK002-53.md)

**TASK002-54**: 数据库迁移脚本 - 采集模块  
**依赖任务**: TASK002-50  
**详细文档**: [TASK002-54.md](TASK002-54.md)

### 基础数据初始化脚本（6个任务）

**TASK002-55**: 基础数据初始化 - 系统配置  
**依赖任务**: TASK002-51  
**详细文档**: [TASK002-55.md](TASK002-55.md)

**TASK002-56**: 基础数据初始化 - 默认角色  
**依赖任务**: TASK002-51  
**详细文档**: [TASK002-56.md](TASK002-56.md)

**TASK002-57**: 基础数据初始化 - 默认权限  
**依赖任务**: TASK002-51  
**详细文档**: [TASK002-57.md](TASK002-57.md)

**TASK002-58**: 基础数据初始化 - 默认用户组  
**依赖任务**: TASK002-51  
**详细文档**: [TASK002-58.md](TASK002-58.md)

**TASK002-59**: 基础数据初始化 - 默认等级  
**依赖任务**: TASK002-51  
**详细文档**: [TASK002-59.md](TASK002-59.md)

**TASK002-60**: 基础数据初始化 - 默认作者类型和作者等级  
**依赖任务**: TASK002-51  
**详细文档**: [TASK002-60.md](TASK002-60.md)

### 数据库连接测试和验证（1个任务）

**TASK002-61**: 数据库连接测试和验证  
**依赖任务**: TASK002-55、TASK002-56、TASK002-57、TASK002-58、TASK002-59、TASK002-60  
**详细文档**: [TASK002-61.md](TASK002-61.md)

---

## Git 提交信息任务

任务完成后，需要生成 Git 提交信息。请根据实际修改内容生成合适的提交信息。

---

## 参考文档

- [项目整体任务文档](../TASKS.md)
- [项目整体需求文档](../../Requirements/Overview.md)
- [核心模块需求文档](../../Requirements/Core.md)
- [存储模块需求文档](../../Requirements/Storage.md)
- [日志模块需求文档](../../Requirements/Log.md)
- [采集模块需求文档](../../Requirements/Crawler.md)
- [PostgreSQL 数据库设计规范](../../../.cursor/rules/database.mdc)
- [Golang 编码规范](../../../.cursor/rules/golang.mdc)

---

**文档版本**: 1.1.0  
**最后更新**: 2026-01-02 22:10:19 CST

